#summary All information about Miner

= Miner =
Являеться компонентом системы ответственным за сбор информации из Сети и ее сохранение в БД. Информация получаемая на выходе программы - унифицированные записи в Сырой БД.
Используемая технология: Web-Harvester.

===Как компилить и запускать Miner===
Для компиляции Miner'a потребуются JAR-файлы web-harvestera. [http://web-harvest.sourceforge.net/download/webharvest2b1-bin.zip Ссылка для скачивания]

Идем в папку amse-agregator и компилим командой:
{{{
 javac -cp <full path to webharvest_2.jar> ru/amse/agregator/miner/Main.java

 Пример:

iv@gate:~/svn/amse-agregator$ javac -cp /home/iv/code/webharvest2b1-bin/webharvest_2.jar ru/amse/agregator/miner/Main.java
}}}

Далее переходим на уровни ниже:
{{{
 cd ru/amse/agregator/miner/
}}}

Запускаем:
{{{
java -cp <path to class>:<path to all WebHarvester JAR files> ru.amse.agregator.miner.Main   resources/<inputfile>

Пример:

iv@gate:~/svn/amse-agregator/ru/amse/agregator/miner$ java -cp ~/svn/amse-agregator/miner/:~/code/webharvest2b1-bin/* ru.amse.agregator.miner.Main resources/main.txt
}}}


Во входном файле храняться пары вида:

'Файл с ссылками;Конфиг файл под эти ресурсы'
{{{
<linksfile>;resources/<configfile>

Пример:

wikilinks.txt;resources/wikipediaconfig.xml
wikitravellinks.txt;resources/wikitravelconfig.xml
}}}

_linksfile_ =  файл состоящий из ссылок, подлежащих обработке, записанных через Enter.

_configfile_ = конфигурационный файл, описывающий как webharvester будет обрабатывать ссылки.

На данный момент в репозиториях лежат конфиг файлы для сбора информации про города из _wikipedia_ и _wikitravel_(wikipediaconfig, wikitravelconfig), и файлики (wikilinks.txt, wikitravellinkst.txt) куда пишуться интересующие нас города на этих ресурсах.   Так же там лежит файл(_main.txt_):
{{{
wikilinks.txt;resources/wikipediaconfig.xml
wikitravellinks.txt;resources/wikitravelconfig.xml
}}}
который и скармливаеться java-программе.

java-программа на выходе выдает информацию вида:
 * Название города
 * Описание
 * Координаты
 * Ссылка на изображение

_Ближайший план:_ Написать config файлы для других ресурсов(_archive.travel.ru, ..._)

Конфиг файлы пишутся таким образом, чтобы программа обрабатывала поступающие данные единым образом; Так, если мы захотим добавить к обработке еще 1 ресурс, все что нам потребуется - это добавить запись в main.txt указав там файлик с ссылками и конфиг файл, саму программу перекомпилировать при этом не требуеться.


Так же при выборе `WebHarvester` в качестве альтернативы, был рассмотрен вариант использовать `Visual Web Ripper`, но он оказался платным, не запускаемым под wine и не имел порта на Java.